<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8">
  <title>Kalkulačka reálné mzdy</title>
  <style>
    .kalkulacka {
      font-family: sans-serif;
      padding: 1rem;
      max-width: 480px;
      margin: auto;
      background-color: #fff;
    }
    .kalkulacka input, .kalkulacka select, .kalkulacka button {
      width: 100%;
      margin-bottom: 1rem;
      padding: 0.5rem;
      font-size: 1rem;
    }
    .kalkulacka .result {
      font-weight: bold;
      margin-top: 1rem;
    }
  </style>
</head>
<body>
  <div class="kalkulacka">
    <h2>Kalkulačka reálné mzdy</h2>

    <label for="pastSalary">Váš plat v minulosti (např. v roce 2019):</label>
    <input type="number" id="pastSalary" placeholder="např. 30000">

    <label for="currentSalary">Váš současný plat:</label>
    <input type="number" id="currentSalary" placeholder="např. 37000">

    <label for="pastYear">Rok minulého platu:</label>
    <select id="pastYear"></select>

    <label for="currentYear">Současný rok:</label>
    <select id="currentYear"></select>

    <button onclick="calculateRealWage()">Spočítat</button>

    <div class="result" id="result"></div>
  </div>

  <script>
    const baseCPI = {
      2019: 108.3,
      2020: 111.8,
      2021: 116.1,
      2022: 133.6,
      2023: 147.8,
      2024: 151.4
    };

    const yearSelects = [document.getElementById("pastYear"), document.getElementById("currentYear")];
    for (const select of yearSelects) {
      for (const year of Object.keys(baseCPI)) {
        const option = document.createElement("option");
        option.value = year;
        option.textContent = year;
        select.appendChild(option);
      }
    }
    document.getElementById("pastYear").value = "2020";
    document.getElementById("currentYear").value = "2024";

    function formatNumberCZ(value) {
      return value.toLocaleString("cs-CZ");
    }

    function formatPercent(value) {
      const rounded = Math.round(value * 10) / 10;
      if (rounded % 1 === 0) {
        return `${rounded.toFixed(0)} %`;
      } else {
        return `${rounded.toFixed(1).replace('.', ',')} %`;
      }
    }

    function calculateRealWage() {
      const pastSalary = parseFloat(document.getElementById("pastSalary").value);
      const currentSalary = parseFloat(document.getElementById("currentSalary").value);
      const pastYear = parseInt(document.getElementById("pastYear").value);
      const currentYear = parseInt(document.getElementById("currentYear").value);

      if (isNaN(pastSalary) || isNaN(currentSalary)) {
        document.getElementById("result").textContent = "Zadejte prosím oba platy.";
        return;
      }

      const normalizedCPI = {};
      for (const year in baseCPI) {
        normalizedCPI[year] = baseCPI[year] / baseCPI[pastYear] * 100;
      }

      const requiredCurrentSalary = pastSalary * (normalizedCPI[currentYear] / 100);
      const difference = currentSalary - requiredCurrentSalary;
      const percentChange = (difference / requiredCurrentSalary) * 100;

      const formattedRequired = formatNumberCZ(Math.round(requiredCurrentSalary));
      const formattedCurrent = formatNumberCZ(Math.round(currentSalary));
      const formattedDiff = formatNumberCZ(Math.abs(Math.round(difference)));
      const formattedPercent = formatPercent(Math.abs(percentChange));

      let statusText = '';

      if (difference < 0) {
        statusText = `Vaše reálná mzda poklesla mezi uvedenými roky o <strong>${formattedPercent}</strong>.<br>
        Abyste si mohl za svou výplatu koupit to stejné, co v roce ${pastYear}, musel byste dnes vydělávat <strong>${formattedRequired} korun</strong>.<br>
        Váš současný plat je <strong>${formattedCurrent} korun</strong>, takže reálně jste na tom <strong>hůře o ${formattedDiff} korun</strong>.`;
      } else {
        statusText = `Vaše reálná mzda vzrostla mezi uvedenými roky o <strong>${formattedPercent}</strong>.<br>
        Ceny sice vzrostly, ale váš příjem rostl rychleji. Pro udržení stejné kupní síly jako v roce ${pastYear} by vám dnes stačilo vydělávat <strong>${formattedRequired} korun</strong>.<br>
        Váš současný plat je <strong>${formattedCurrent} korun</strong>, takže reálně jste na tom <strong>lépe o ${formattedDiff} korun</strong>.`;
      }

      document.getElementById("result").innerHTML = statusText;
    }
  </script>
</body>
</html>
