<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8">
  <title>Kalkulačka reálné mzdy</title>
  <style>
    .kalkulacka {
      font-family: sans-serif;
      padding: 1rem;
      max-width: 480px;
      margin: auto;
      background-color: #fff;
    }
    .kalkulacka input, .kalkulacka select, .kalkulacka button {
      width: 100%;
      margin-bottom: 1rem;
      padding: 0.5rem;
      font-size: 1rem;
    }
    .kalkulacka .result {
      font-weight: bold;
      margin-top: 1rem;
    }
  </style>
</head>
<body>
  <div class="kalkulacka">
    <h2>Kalkulačka reálné mzdy</h2>

    <label for="pastSalary">Váš plat v minulosti (např. v roce 2019):</label>
    <input type="number" id="pastSalary" placeholder="např. 30000">

    <label for="currentSalary">Váš současný plat:</label>
    <input type="number" id="currentSalary" placeholder="např. 37000">

    <label for="pastYear">Rok minulého platu:</label>
    <select id="pastYear"></select>

    <label for="currentYear">Současný rok:</label>
    <select id="currentYear"></select>

    <button onclick="calculateRealWage()">Spočítat</button>

    <div class="result" id="result"></div>
  </div>

  <script>
    const cpiMap = {
      "2019": {"2019": 100.0,"2020": 103.232,"2021": 107.202,"2022": 123.361,"2023": 136.473,"2024": 139.797},
      "2020": {"2019": 96.869,"2020": 100.0,"2021": 103.846,"2022": 119.499,"2023": 132.2,"2024": 135.42},
      "2021": {"2019": 93.282,"2020": 96.296,"2021": 100.0,"2022": 115.073,"2023": 127.304,"2024": 130.405},
      "2022": {"2019": 81.063,"2020": 83.683,"2021": 86.901,"2022": 100.0,"2023": 110.629,"2024": 113.323},
      "2023": {"2019": 73.275,"2020": 75.643,"2021": 78.552,"2022": 90.392,"2023": 100.0,"2024": 102.436},
      "2024": {"2019": 71.532,"2020": 73.844,"2021": 76.684,"2022": 88.243,"2023": 97.622,"2024": 100.0}
    };

    const yearSelects = [document.getElementById("pastYear"), document.getElementById("currentYear")];
    for (const select of yearSelects) {
      for (const year of Object.keys(cpiMap)) {
        const option = document.createElement("option");
        option.value = year;
        option.textContent = year;
        select.appendChild(option);
      }
    }
    document.getElementById("pastYear").value = "2019";
    document.getElementById("currentYear").value = "2024";

    function formatNumberCZ(value) {
      return value.toLocaleString("cs-CZ");
    }

    function formatPercent(value) {
      const rounded = Math.round(value * 10) / 10;
      if (rounded % 1 === 0) {
        return `${rounded.toFixed(0)} %`;
      } else {
        return `${rounded.toFixed(1).replace('.', ',')} %`;
      }
    }

    function calculateRealWage() {
      const pastSalary = parseFloat(document.getElementById("pastSalary").value);
      const currentSalary = parseFloat(document.getElementById("currentSalary").value);
      const pastYear = document.getElementById("pastYear").value;
      const currentYear = document.getElementById("currentYear").value;

      if (isNaN(pastSalary) || isNaN(currentSalary)) {
        document.getElementById("result").textContent = "Zadejte prosím oba platy.";
        return;
      }

      const relativeIndex = cpiMap[pastYear][currentYear];
      const requiredCurrentSalary = pastSalary * (relativeIndex / 100);
      const difference = currentSalary - requiredCurrentSalary;
      const percentChange = (difference / requiredCurrentSalary) * 100;

      const formattedRequired = formatNumberCZ(Math.round(requiredCurrentSalary));
      const formattedCurrent = formatNumberCZ(Math.round(currentSalary));
      const formattedDiff = formatNumberCZ(Math.abs(Math.round(difference)));
      const formattedPercent = formatPercent(Math.abs(percentChange));

      let statusText = '';

      if (difference < 0) {
        statusText = `Vaše reálná mzda poklesla mezi uvedenými roky o <strong>${formattedPercent}</strong>.<br>
        Abyste si mohl za svou výplatu koupit to stejné, co v roce ${pastYear}, musel byste dnes vydělávat <strong>${formattedRequired} korun</strong>.<br>
        Váš současný plat je <strong>${formattedCurrent} korun</strong>, takže reálně jste na tom <strong>hůře o ${formattedDiff} korun</strong>.`;
      } else {
        statusText = `Vaše reálná mzda vzrostla mezi uvedenými roky o <strong>${formattedPercent}</strong>.<br>
        Ceny sice vzrostly, ale váš příjem rostl rychleji. Pro udržení stejné kupní síly jako v roce ${pastYear} by vám dnes stačilo vydělávat <strong>${formattedRequired} korun</strong>.<br>
        Váš současný plat je <strong>${formattedCurrent} korun</strong>, takže reálně jste na tom <strong>lépe o ${formattedDiff} korun</strong>.`;
      }

      document.getElementById("result").innerHTML = statusText;
    }
  </script>
</body>
</html>
